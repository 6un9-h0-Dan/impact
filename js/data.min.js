/*!
 * Start Bootstrap - ML CO2 Impact v5.0.8 ()
 * Copyright 2013-2019 
 * Licensed under MIT (https://github.com/BlackrockDigital/ml-co2-impact/blob/master/LICENSE)
 */

"use strict";function asyncGeneratorStep(t,e,r,a,n,o,s){try{var u=t[o](s),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(a,n)}function _asyncToGenerator(u){return function(){var t=this,s=arguments;return new Promise(function(e,r){var a=u.apply(t,s);function n(t){asyncGeneratorStep(a,e,r,n,o,"next",t)}function o(t){asyncGeneratorStep(a,e,r,n,o,"throw",t)}n(void 0)})}}var dev_base_data_url="/data/",prod_base_data_url="/impact/data/",serveFrom="dev",parseProvidersData=function(t){var e={},r=!0,a=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value,c=u.provider,i=u.region,p=u.country,v=u.state,l=u.city,d=u.source,y=u.comment,_=u.providerName,f=u.offsetRatio,m=parseInt(u.impact,10),g=u.regionName;g=g||i,c in e||(e[c]={__min:{impact:1e4,region:""}}),m<e[c].__min.impact&&(e[c].__min={region:i,impact:m}),e[c][i]={regionName:g,country:p,state:v,city:l,source:d,comment:y,providerName:_,offsetRatio:f,impact:parseFloat(m)}}}catch(t){a=!0,n=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw n}}return e},parseGPUData=function(t){var e={},r=1e6,a=!0,n=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var c=s.value,i=c.name,p=c.watt;e[i]={watt:parseFloat(p)},parseFloat(p)<r&&(r=parseFloat(p))}}catch(t){n=!0,o=t}finally{try{a||null==u.return||u.return()}finally{if(n)throw o}}return e};function getProvidersData(){return _getProvidersData.apply(this,arguments)}function _getProvidersData(){return(_getProvidersData=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$.ajax({type:"GET",url:prod_base_data_url+"impact.csv",dataType:"text"});case 3:return e=t.sent,serveFrom="prod",t.abrupt("return",e);case 8:return t.prev=8,t.t0=t.catch(0),t.prev=10,t.next=13,$.ajax({type:"GET",url:dev_base_data_url+"impact.csv",dataType:"text"});case 13:return e=t.sent,t.abrupt("return",e);case 17:t.prev=17,t.t1=t.catch(10),console.log("Error getting providers:"),console.error(t.t1);case 21:case"end":return t.stop()}},t,null,[[0,8],[10,17]])}))).apply(this,arguments)}function getGPUData(){return _getGPUData.apply(this,arguments)}function _getGPUData(){return(_getGPUData=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$.ajax({type:"GET",url:prod_base_data_url+"gpus.csv",dataType:"text"});case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),t.prev=9,t.next=12,$.ajax({type:"GET",url:dev_base_data_url+"gpus.csv",dataType:"text"});case 12:return e=t.sent,t.abrupt("return",e);case 16:t.prev=16,t.t1=t.catch(9),console.log("Error getting providers:"),console.error(t.t1);case 20:case"end":return t.stop()}},t,null,[[0,7],[9,16]])}))).apply(this,arguments)}function getData(){return _getData.apply(this,arguments)}function _getData(){return(_getData=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,getProvidersData();case 2:return e=t.sent,t.next=5,getGPUData();case 5:return r=t.sent,t.abrupt("return",{providers:parseProvidersData($.csv.toObjects(e)),gpus:parseGPUData($.csv.toObjects(r))});case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}