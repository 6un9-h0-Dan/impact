/*!
 * Start Bootstrap - ML CO2 Impact v5.0.8 ()
 * Copyright 2013-2019 
 * Licensed under MIT (https://github.com/BlackrockDigital/ml-co2-impact/blob/master/LICENSE)
 */

"use strict";function asyncGeneratorStep(e,t,n,o,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(t,n){var o=s.apply(e,i);function r(e){asyncGeneratorStep(o,t,n,r,a,"next",e)}function a(e){asyncGeneratorStep(o,t,n,r,a,"throw",e)}r(void 0)})}}var state,FEATURES=["gpu","provider","region","hours"];function getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function findGetParameter(t){var n=null,o=[];return location.search.substr(1).split("&").forEach(function(e){(o=e.split("="))[0]===t&&(n=decodeURIComponent(o[1]))}),n}function insertParam(e,t,n){t=encodeURI(t),n=encodeURI(n);for(var o,r=e.length;r--;)if((o=e[r].split("="))[0]==t){o[1]=n,e[r]=o.join("=");break}return r<0&&(e[e.length]=[t,n].join("=")),e}function sc(e){$("html,body").animate({scrollTop:$("#"+e).offset().top-parseInt($("#"+e).height()/1.2)},"slow")}var getValues=function(){return{gpu:$("#compute-gpu option:selected").val(),provider:$("#compute-provider option:selected").val(),region:$("#compute-region option:selected").val(),hours:parseInt($("#compute-hours").val(),10)}},fail=function(e){$("#result-card").hide(),$(".spinner-border").hide(),$("#compute-"+e).css("border","2px solid red"),setInputs()},check=function(e,n){switch($("#compute-hours").css("border",""),e){case"gpu":return console.log(state.gpus,n),state.gpus.filter(function(e,t){return e.name===n}).length;case"hours":return Number.isInteger(n)&&0<n&&n<1e6;case"provider":return state.providers.filter(function(e,t){return e.name===n}).length;case"region":return state.regions.filter(function(e,t){return e.name===n}).length;default:return!0}},checkForm=function(){var e=getValues();e.gpu,e.provider,e.region,e.hours;console.log({values:e});var n=!1;return FEATURES.forEach(function(e,t){check(t,e)||(fail(t),n=!0)}),n?null:e},submitCompute=function(e){$("#result-card").hide(),$(".spinner-border").show();var t=getValues();if(console.log(t),t){var n=t.gpu,o=t.hours,r=t.provider,a=t.region,i=state.gpus[n].watt*o*state.providers[r][a].impact/1e3,s=i*state.providers[r][a].offsetRatio/100;$("#emitted-value").text(parseInt(i)),$("#offset-value").text(parseInt(s)),$("#details-counts").text("".concat(state.gpus[n].watt," x ").concat(o," x ").concat(state.providers[r][a].impact/1e3)),setTimeout(function(){$(".spinner-border").hide(),$("#result-card").fadeIn(),$(window).width()<769&&$("#goToResults").trigger("click")},getRandomInt(500,1200))}},parseGetParams=function(){for(var e={},t=0,n=FEATURES;t<n.length;t++){var o=n[t],r=findGetParameter(o);console.log(o,r,check(o,r)),"hours"===o&&(r=parseInt(r)),r&&check(o,r)&&(e[o]=r)}console.log("get param values",e),$.isEmptyObject(e)?window.history.pushState("","",window.location.pathname):(setGetParams(e),updateInputs(e),setTimeout(function(){$("#compute-nav-link").trigger("click")},500))},setGetParams=function(e){var t=[];for(var n in e){if(e.hasOwnProperty(n))t=insertParam(t,n,e[n])}window.history.pushState("","","?"+t.join("&"))},updateInputs=function(e){for(var t=0,n=FEATURES;t<n.length;t++){var o=n[t];e.hasOwnProperty(o)&&$("#compute-"+o).val(e[o])}},setInputs=function(){["gpu","region","provider"].forEach(function(e,t){$("#compute-"+e).html(state[e+"s"].map(function(e,t){return'<option value="'.concat(e.name,'">').concat(e.name,"</option>")}).join(""))})},setRegion=function(e){$("#compute-region").html("");var t=[];for(var n in state.providers[e])if(state.providers[e].hasOwnProperty(n)){var o=state.providers[e][n].regionName;o||(o=n),t.push({region:n,regionName:o})}t.sort(function(e,t){return e.regionName>t.regionName?1:t.regionName>e.regionName?-1:0});for(var r=0,a=t;r<a.length;r++){var i=a[r],s=i.regionName,c=i.region;$("#compute-region").append('<option value="'.concat(c,'">').concat(s,"</option>"))}},setInputs2=function(){for(var e in state.gpus)$("#compute-gpu").append('<option value="'.concat(e,'">').concat(e,"</option>"));var t,n=0;for(var o in state.providers)if(0==n&&(t=o),n++,state.providers.hasOwnProperty(o)){var r=void 0;for(var a in state.providers[o])if(state.providers[o].hasOwnProperty(a)){r=state.providers[o][a].providerName;break}$("#compute-provider").append('<option value="'.concat(o,'">').concat(r,"</option>"))}setRegion(t)};!function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(o){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=o(this.hash);if((e=e.length?e:o("[name="+this.hash.slice(1)+"]")).length){o("html, body").animate({scrollTop:e.offset().top-70},1e3,"easeInOutExpo");var t=window.location.pathname;return"/"!==t[t.length-1]&&(t+="/"),window.history.pushState("","",t+this.hash),!1}}}),o(".js-scroll-trigger").click(function(){o(".navbar-collapse").collapse("hide")}),o("body").scrollspy({target:"#mainNav",offset:100}),(t=function(){100<o("#mainNav").offset().top?o("#mainNav").addClass("navbar-shrink"):o("#mainNav").removeClass("navbar-shrink")})(),o(window).scroll(t),e.next=8,getData();case 8:state=e.sent,console.log(state),setInputs2(),o("#compute-provider").change(function(e){var t=o("#compute-provider option:selected").val();setRegion(t)}),o("#compute-form").submit(function(e){return submitCompute(),!1}),o(".compute-input").change(function(){o("#compute-submit").prop("disabled",!0),checkForm()&&o("#compute-submit").prop("disabled",!1)}),o(".arrow-icon").click(function(){if(o(this).hasClass("open")){var n=0;o("#details-content").children().each(function(e,t){n+=o(t).innerHeight()}),o("#details-content").height(n)}else o("#details-content").height(0);o(this).toggleClass("open")});case 15:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()(jQuery);