/*!
 * Start Bootstrap - ML CO2 Impact v5.0.8 ()
 * Copyright 2013-2019 
 * Licensed under MIT (https://github.com/BlackrockDigital/ml-co2-impact/blob/master/LICENSE)
 */

"use strict";function asyncGeneratorStep(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(s){return function(){var e=this,i=arguments;return new Promise(function(t,n){var r=s.apply(e,i);function o(e){asyncGeneratorStep(r,t,n,o,a,"next",e)}function a(e){asyncGeneratorStep(r,t,n,o,a,"throw",e)}o(void 0)})}}var state,FEATURES=["gpu","provider","region","hours"];function getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function findGetParameter(t){var n=null,r=[];return location.search.substr(1).split("&").forEach(function(e){(r=e.split("="))[0]===t&&(n=decodeURIComponent(r[1]))}),n}function insertParam(e,t,n){t=encodeURI(t),n=encodeURI(n);for(var r,o=e.length;o--;)if((r=e[o].split("="))[0]==t){r[1]=n,e[o]=r.join("=");break}return o<0&&(e[e.length]=[t,n].join("=")),e}function sc(e){$("html,body").animate({scrollTop:$("#"+e).offset().top-parseInt($("#"+e).height()/1.2)},"slow")}var setImports=function(e,t,r){var o="dev"===e;$(t).each(function(e,t){var n=$(t).attr(r);n&&0<=n.indexOf("...")&&$(t).attr(r,o?n.split("...")[1]:"/impact"+n.split("...")[1])})},getValues=function(){return{gpu:$("#compute-gpu option:selected").val(),provider:$("#compute-provider option:selected").val(),region:$("#compute-region option:selected").val(),hours:parseInt($("#compute-hours").val(),10)}},fail=function(e){$("#result-card").hide(),$(".spinner-border").hide(),$("#compute-"+e).css("border","2px solid red"),setInputs()},scrollToBottomResultCard=function(){var e=$("#result-card").offset().top+$("#result-card").outerHeight()-$(window).height()+50;$("html, body").animate({scrollTop:e},1e3,"easeInOutExpo")},growDivOnArrowClick=function(e,t){$(e).click(function(){if($(this).find(".arrow-icon").hasClass("open"))$(t).height(0),setTimeout(function(){scrollToBottomResultCard()},500);else{var n=0;$(t).children().each(function(e,t){n+=$(t).innerHeight()}),$(t).height(n),setTimeout(function(){$(window).height()>$("#result-card").outerHeight()+150&&scrollToBottomResultCard()},500)}$(this).find(".arrow-icon").toggleClass("open")})},growDivOnArrowClickLearn=function(e,t){$(e).click(function(){if($(this).find(".arrow-icon").hasClass("open"))$(this).siblings(t).height(0);else{var n=0;$(this).siblings(t).children().each(function(e,t){n+=$(t).innerHeight()}),$(this).siblings(t).height(n)}$(this).find(".arrow-icon").toggleClass("open")})},check=function(e,n){switch($("#compute-hours").css("border",""),e){case"gpu":return console.log(state.gpus,n),state.gpus.filter(function(e,t){return e.name===n}).length;case"hours":return Number.isInteger(n)&&0<n&&n<1e6;case"provider":return state.providers.filter(function(e,t){return e.name===n}).length;case"region":return state.regions.filter(function(e,t){return e.name===n}).length;default:return!0}},checkForm=function(){var e=getValues();e.gpu,e.provider,e.region,e.hours;console.log({values:e});var n=!1;return FEATURES.forEach(function(e,t){check(t,e)||(fail(t),n=!0)}),n?null:e},setDetails=function(e){var t=e.gpu,n=e.hours,r=e.provider,o=e.region,a=state.gpus[t].watt*n,i=parseInt(a*state.providers[r][o].impact/1e3,10),s=parseInt(i*state.providers[r][o].offsetRatio/100,10);$("#emitted-value").text(i),$("#offset-value").text(s),$("#details-counts").html("\n  ".concat(state.gpus[t].watt,"W x ").concat(n,"h x ").concat(state.providers[r][o].impact/1e3," \n  kg CO<sub>2</sub>/kWh = ").concat(i," kg eq. CO<sub>2</sub>\n  "));var c=state.providers[r][o].providerName,l=state.providers[r].__min.region,u=state.providers[r][l];if(o!==l){var p=parseInt(a*u.impact/1e3,10);$("#details-min-selected").hide(),$("#details-alternative").html("\n      Had this model been run in ".concat(c,"'s <strong>").concat(u.regionName,"</strong> region,\n      the carbon emitted would have been of <strong>").concat(p,"</strong> kg eq. CO<sub>2</sub>\n      ")),$("#details-alternative").show()}else $("#details-min-selected").show(),$("#details-alternative").hide(),$("#details-min-region").html("\n      You have selected ".concat(c,"'s cleanest region!\n      "))},submitCompute=function(e){$("#result-card").hide(),$("#details-content").height(0),$("#details-banner .arrow-icon").removeClass("open"),$(".spinner-border").show();var t=getValues();t&&(setDetails(t),state.current=t,setTimeout(function(){$(".spinner-border").hide(),$("#result-card").fadeIn();var e=$("#result-card").offset().top+$("#result-card").outerHeight()<$(window).scrollTop()+$(window).height();console.log($(window).scrollTop()+$(window).height()),($(window).width()<769||!e)&&scrollToBottomResultCard()},getRandomInt(500,1200)))},setRegion=function(e){$("#compute-region").html("");var t=[];for(var n in state.providers[e])if(state.providers[e].hasOwnProperty(n)&&"__min"!==n){var r=state.providers[e][n].regionName;r||(r=n),t.push({region:n,regionName:r})}t.sort(function(e,t){return e.regionName>t.regionName?1:t.regionName>e.regionName?-1:0});for(var o=0,a=t;o<a.length;o++){var i=a[o],s=i.regionName,c=i.region;$("#compute-region").append('<option value="'.concat(c,'">').concat(s,"</option>"))}},setInputs2=function(){for(var e in state.gpus)$("#compute-gpu").append('<option value="'.concat(e,'">').concat(e,"</option>"));var t,n=0;for(var r in state.providers)if(0==n&&(t=r),n++,state.providers.hasOwnProperty(r)){var o=void 0;for(var a in state.providers[r])if(state.providers[r].hasOwnProperty(a)&&"__min"!==a){o=state.providers[r][a].providerName;break}$("#compute-provider").append('<option value="'.concat(r,'">').concat(o,"</option>"))}setRegion(t)};!function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(n){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=n(this.hash);if((e=e.length?e:n("[name="+this.hash.slice(1)+"]")).length){n("html, body").animate({scrollTop:e.offset().top-70},1e3,"easeInOutExpo");var t=window.location.pathname;return"/"!==t[t.length-1]&&(t+="/"),window.history.pushState("","",t+this.hash),!1}}}),n(".js-scroll-trigger").click(function(){n(".navbar-collapse").collapse("hide")}),n("body").scrollspy({target:"#mainNav",offset:100}),n('[data-spy="scroll"]').on("activate.bs.scrollspy",function(){console.log(this)}),(t=function(){100<n("#mainNav").offset().top?n("#mainNav").addClass("navbar-shrink"):n("#mainNav").removeClass("navbar-shrink")})(),n(window).scroll(t),e.next=9,getData();case 9:state=e.sent,setInputs2(),setImports(serveFrom,"a","href"),setImports(serveFrom,"img","src"),n("#compute-provider").change(function(e){var t=n("#compute-provider option:selected").val();setRegion(t)}),n("#compute-form").submit(function(e){return submitCompute(),!1}),n(".compute-input").change(function(){n("#compute-submit").prop("disabled",!0),checkForm()&&n("#compute-submit").prop("disabled",!1)}),n(".details-summary").each(function(e,t){if(e%2==0){n(t).append(n('\n      <a class="arrow-icon arrow-learn-even" title="Learn more">\n      <span class="left-bar"></span>\n      <span class="right-bar"></span>\n      </a>\n      '))}else{n(t).css("justify-content","flex-end"),n(t).prepend(n('\n      <a class="arrow-icon arrow-learn-odd" title="Learn more">\n      <span class="left-bar"></span>\n      <span class="right-bar"></span>\n      </a>\n      '))}}),growDivOnArrowClickLearn(".details-summary",".summary-content"),growDivOnArrowClick("#details-banner","#details-content");case 19:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()(jQuery);